<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Address Parsing in R • postmastr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Address Parsing in R">
<meta property="og:description" content="">
<meta property="og:image" content="https://slu-openGIS.github.io/postmastr/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">postmastr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/postmastr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/slu-openGIS/postmastr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Address Parsing in R</h1>
                        <h4 class="author">Christopher Prener, Ph.D.</h4>
            
            <h4 class="date">2019-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slu-openGIS/postmastr/blob/master/vignettes/postmastr.Rmd"><code>vignettes/postmastr.Rmd</code></a></small>
      <div class="hidden name"><code>postmastr.Rmd</code></div>

    </div>

    
    
<p><code>postmastr</code> is designed to be an <em>opinionated</em> toolkit for parsing street addresses using <code>R</code>. It was originally created to standardize addresses prior to geocoding the, in an effort to increase the geocoder’s ability to correctly match a given address with the appropriate coordinates.</p>
<div id="a-grammar-of-street-addresses" class="section level2">
<h2 class="hasAnchor">
<a href="#a-grammar-of-street-addresses" class="anchor"></a>A Grammar of Street Addresses</h2>
<div id="the-anatomy-of-an-american-street-address" class="section level3">
<h3 class="hasAnchor">
<a href="#the-anatomy-of-an-american-street-address" class="anchor"></a>The Anatomy of an American Street Address</h3>
<p>While street addresses have a significant amount of variation, they also are ordered in a relatively standardized fashion. Take, for example, an address from <code>sushi1</code> (one of the example data sets in <code>postmastr</code>): <code>601 Clark Ave Suite 104, St. Louis, MO 63102-1719</code>. We can break down the address in the following way:</p>
<ul>
<li>
<em>house number</em> - <code>601</code>
</li>
<li>
<em>street</em> name - <code>Clark</code>
</li>
<li>
<em>street</em> suffix - <code>Ave</code>
</li>
<li>
<em>unit</em> type - <code>Suite</code>
</li>
<li>
<em>unit</em> number - <code>104</code>
</li>
<li>
<em>city</em> - <code>St. Louis</code>
</li>
<li>
<em>state</em> - <code>MO</code>
</li>
<li>
<em>postal code</em> - <code>63102-1719</code>
</li>
</ul>
<p>There is sometimes additional information as well. Imagine that the house number in the example above was <code>601-603</code> instead. We could break this more complex number down in the following way:</p>
<ul>
<li>
<em>house number</em> - <code>601-603</code>
</li>
<li>
<em>house number</em> lower value - <code>601</code>
</li>
<li>
<em>house number</em> upper value - <code>603</code>
</li>
</ul>
<p>Another permutation has to do with the <em>house number</em> suffix. Imagine a house number that is <code>601R</code> or <code>601 Rear</code>:</p>
<ul>
<li>
<em>house number</em> - <code>601</code>
</li>
<li>
<em>house number</em> suffix - <code>R</code>
</li>
</ul>
<p>Finally, streets in the United States sometimes contain either a <em>street</em> prefix direction (<code>601 North Clark Ave</code>) or a <em>street</em> suffix direction (<code>601 Clark Ave North</code>).</p>
<p>This basic anatomy of a street address forms our <em>grammar of street addresses</em> - a specific language for thinking about how addresses are formed and therefore can be parsed.</p>
</div>
<div id="basic-organization-of-postmastr" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-organization-of-postmastr" class="anchor"></a>Basic Organization of <code>postmastr</code>
</h3>
<p>To parse our <em>grammar of street addresses</em>, functions can be grouped in two ways. All functions begin with the prefix <code>pm_</code> in order to take advantage of RStudio’s auto-complete functionality.</p>
<p>First, we have major groups of functions based on their associated grammatical element:</p>
<ul>
<li>
<code>house</code> - <em>house number</em>
</li>
<li>
<code>houseAlpha</code> - alphanumeric <em>house number</em>
</li>
<li>
<code>houseFrac</code> - fractional <em>house number</em>
</li>
<li>
<code>street</code> - <em>street</em> name</li>
<li>
<code>streetDir</code> - <em>street</em> prefix and suffix direction</li>
<li>
<code>streetSuf</code> - <em>street</em> suffix</li>
<li>
<code>unit</code> - <em>unit</em> name and number</li>
<li>
<code>city</code> - <em>city</em>
</li>
<li>
<code>state</code> - <em>state</em>
</li>
<li>
<code>postal</code> - <em>postal code</em>
</li>
</ul>
<p>For each group of function, we have a similar menu of options that describe the <em>verb</em> (action) the function implements. For the <code>state</code> family of functions, for instance:</p>
<ul>
<li>
<code><a href="../reference/pm_state_detect.html">pm_state_detect()</a></code> - does a given street address contain a state name or abbreviation?</li>
<li>
<code><a href="../reference/pm_state_any.html">pm_state_any()</a></code> - does a any street address contain a state name or abbreviation?</li>
<li>
<code><a href="../reference/pm_state_all.html">pm_state_all()</a></code> - do all street addresses contain a state name or abbreviation?</li>
<li>
<code><a href="../reference/pm_state_none.html">pm_state_none()</a></code> - returns a tibble of street addresses that <em>do not</em> contain a state name or abbreviation</li>
<li>
<code><a href="../reference/pm_state_parse.html">pm_state_parse()</a></code> - parses street addresses that <em>do</em> contain a street name or abbreviation</li>
<li>
<code><a href="../reference/pm_state_std.html">pm_state_std()</a></code> - standardizes the parsed state data to return upper-case abbreviations</li>
</ul>
</div>
</div>
<div id="creating-dictionaries" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-dictionaries" class="anchor"></a>Creating Dictionaries</h2>
<p>Dictionaries are a critical component of the <code>postmastr</code> workflow because they allow you to define the terms that need to be parsed and standardized. Using well-defined dictionaries can speed up the parsing process and ensure that it is accurate.</p>
<div id="state-dictionaries" class="section level3">
<h3 class="hasAnchor">
<a href="#state-dictionaries" class="anchor"></a>State Dictionaries</h3>
<p><code>postmastr</code> comes with a built-in dictionary of states and their abbreviations that can be expanded and filtered using <code><a href="../reference/pm_dictionary.html">pm_dictionary()</a></code> and <code><a href="../reference/pm_append.html">pm_append()</a></code>. On its own, <code><a href="../reference/pm_dictionary.html">pm_dictionary()</a></code> will return that built-in dictionary with a variety of entries based on what we specify for case:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">case =</span> <span class="st">"title"</span>, <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># A tibble: 124 x 2</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">   state.output state.input                                     </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                           </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> AA           AA                                              </a>
<a class="sourceLine" id="cb1-6" data-line-number="6"> <span class="dv">2</span> AA           Armed Forces Americas                           </a>
<a class="sourceLine" id="cb1-7" data-line-number="7"> <span class="dv">3</span> AE           AE                                              </a>
<a class="sourceLine" id="cb1-8" data-line-number="8"> <span class="dv">4</span> AE           Armed Forces Europe, the Middle East, and Canada</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"> <span class="dv">5</span> AK           AK                                              </a>
<a class="sourceLine" id="cb1-10" data-line-number="10"> <span class="dv">6</span> AK           Alaska                                          </a>
<a class="sourceLine" id="cb1-11" data-line-number="11"> <span class="dv">7</span> AL           AL                                              </a>
<a class="sourceLine" id="cb1-12" data-line-number="12"> <span class="dv">8</span> AL           Alabama                                         </a>
<a class="sourceLine" id="cb1-13" data-line-number="13"> <span class="dv">9</span> AP           AP                                              </a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="dv">10</span> AP           Armed Forces Pacific                            </a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># … with 114 more rows</span></a></code></pre></div>
<p>We can customize this mix of cases by using <code>"upper"</code> and <code>"lower"</code> as well. For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">case =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"title"</span>, <span class="st">"upper"</span>), <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># A tibble: 186 x 2</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">   state.output state.input                                     </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                           </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> AA           AA                                              </a>
<a class="sourceLine" id="cb2-6" data-line-number="6"> <span class="dv">2</span> AA           Armed Forces Americas                           </a>
<a class="sourceLine" id="cb2-7" data-line-number="7"> <span class="dv">3</span> AA           ARMED FORCES AMERICAS                           </a>
<a class="sourceLine" id="cb2-8" data-line-number="8"> <span class="dv">4</span> AE           AE                                              </a>
<a class="sourceLine" id="cb2-9" data-line-number="9"> <span class="dv">5</span> AE           Armed Forces Europe, the Middle East, and Canada</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"> <span class="dv">6</span> AE           ARMED FORCES EUROPE, THE MIDDLE EAST, AND CANADA</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"> <span class="dv">7</span> AK           AK                                              </a>
<a class="sourceLine" id="cb2-12" data-line-number="12"> <span class="dv">8</span> AK           Alaska                                          </a>
<a class="sourceLine" id="cb2-13" data-line-number="13"> <span class="dv">9</span> AK           ALASKA                                          </a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="dv">10</span> AL           AL                                              </a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># … with 176 more rows</span></a></code></pre></div>
<p>If only a subset of states are included in your data, you can improve <code>postmastr</code>’s performance by limiting your state dictionary’s contents. The <code>filter</code> argument can accept scalar or vector inputs of two-letter state abbreviations. For instance, we could construction a state dictionary that contains only the states along the Gulf of Mexico:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">filter =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AL"</span>, <span class="st">"FL"</span>, <span class="st">"LA"</span>, <span class="st">"MS"</span>, <span class="st">"TX"</span>), <span class="dt">case =</span> <span class="st">"title"</span>, <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># A tibble: 10 x 2</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">   state.output state.input</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> AL           AL         </a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> <span class="dv">2</span> AL           Alabama    </a>
<a class="sourceLine" id="cb3-7" data-line-number="7"> <span class="dv">3</span> FL           FL         </a>
<a class="sourceLine" id="cb3-8" data-line-number="8"> <span class="dv">4</span> FL           Florida    </a>
<a class="sourceLine" id="cb3-9" data-line-number="9"> <span class="dv">5</span> LA           LA         </a>
<a class="sourceLine" id="cb3-10" data-line-number="10"> <span class="dv">6</span> LA           Louisiana  </a>
<a class="sourceLine" id="cb3-11" data-line-number="11"> <span class="dv">7</span> MS           MS         </a>
<a class="sourceLine" id="cb3-12" data-line-number="12"> <span class="dv">8</span> MS           Mississippi</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"> <span class="dv">9</span> TX           TX         </a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="dv">10</span> TX           Texas     </a></code></pre></div>
<p>The state dictionary can also be expanded. For instance, there are several common abbreviations for Mississippi - “Miss” and “MISS”. We can create an appendix with <code><a href="../reference/pm_append.html">pm_append()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>miss &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_append.html">pm_append</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">input =</span> <span class="st">"Miss"</span>, <span class="dt">output =</span> <span class="st">"MS"</span>, <span class="dt">locale =</span> <span class="st">"us"</span>)</a></code></pre></div>
<p>Once this has been created, we can combine it with the default state dictionary to create our custom dictionary output:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">append =</span> miss, </a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="op">+</span><span class="st">     </span><span class="dt">filter =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AL"</span>, <span class="st">"FL"</span>, <span class="st">"LA"</span>, <span class="st">"MS"</span>, <span class="st">"TX"</span>), </a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="op">+</span><span class="st">     </span><span class="dt">case =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"title"</span>, <span class="st">"upper"</span>), <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># A tibble: 17 x 2</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">   state.output state.input</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span> AL           AL         </a>
<a class="sourceLine" id="cb5-8" data-line-number="8"> <span class="dv">2</span> AL           Alabama    </a>
<a class="sourceLine" id="cb5-9" data-line-number="9"> <span class="dv">3</span> AL           ALABAMA    </a>
<a class="sourceLine" id="cb5-10" data-line-number="10"> <span class="dv">4</span> FL           FL         </a>
<a class="sourceLine" id="cb5-11" data-line-number="11"> <span class="dv">5</span> FL           Florida    </a>
<a class="sourceLine" id="cb5-12" data-line-number="12"> <span class="dv">6</span> FL           FLORIDA    </a>
<a class="sourceLine" id="cb5-13" data-line-number="13"> <span class="dv">7</span> LA           LA         </a>
<a class="sourceLine" id="cb5-14" data-line-number="14"> <span class="dv">8</span> LA           Louisiana  </a>
<a class="sourceLine" id="cb5-15" data-line-number="15"> <span class="dv">9</span> LA           LOUISIANA  </a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="dv">10</span> MS           MS         </a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="dv">11</span> MS           Mississippi</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="dv">12</span> MS           Miss       </a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="dv">13</span> MS           MISSISSIPPI</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="dv">14</span> MS           MISS       </a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="dv">15</span> TX           TX         </a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="dv">16</span> TX           Texas      </a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="dv">17</span> TX           TEXAS  </a></code></pre></div>
<p>All of the different inputs for Mississippi will now return the same <code>MS</code> output.</p>
</div>
<div id="other-dictionaries" class="section level3">
<h3 class="hasAnchor">
<a href="#other-dictionaries" class="anchor"></a>Other Dictionaries</h3>
<p>The only required dictionary for U.S. street addresses is the city dictionary, because there municipalities and place names in the U.S. are so numerous that we cannot build a single, efficient object to use as a default. <code>postmastr</code> comes with default U.S. dictionaries for states (shown above), street directionals, street suffixes, and unit types. It is also possible to build street name dictionaries to correct common misspellings and to create dictionaries for house suffix values (e.g. “Front” or “Rear” addresses).</p>
</div>
</div>
<div id="sample-data" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-data" class="anchor"></a>Sample Data</h2>
<p>To illustrate the core components of the <code>postmastr</code> workflow, we’ll use some data on sushi restaurants in the St. Louis, Missouri region. These are “long” data - some restaurants appear multiple times. Here is a quick preview of the data:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># A tibble: 30 x 3</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">   name                            address                                           visit   </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                             </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St, St. Louis, Missouri <span class="dv">63103</span>          <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb6-6" data-line-number="6"> <span class="dv">2</span> Blue Ocean Restaurant           <span class="dv">6335</span> Delmar Blvd, St. Louis, MO <span class="dv">63112</span>             <span class="dv">10</span><span class="op">/</span><span class="dv">26</span><span class="op">/</span><span class="dv">18</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"> <span class="dv">3</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard, St. Louis, MO <span class="dv">63118</span>       <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"> <span class="dv">4</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave <span class="co">#104, St. Louis, MO 63102-1719      4/28/18 </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"> <span class="dv">5</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span>, St. Louis, MO <span class="dv">63102-1719</span> <span class="dv">5</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb6-10" data-line-number="10"> <span class="dv">6</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span>, St. Louis, MO <span class="dv">63102-1719</span> <span class="dv">8</span><span class="op">/</span><span class="dv">7</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb6-11" data-line-number="11"> <span class="dv">7</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza, St. Louis, MO <span class="dv">63108</span>             <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb6-12" data-line-number="12"> <span class="dv">8</span> I Love Mr Sushi                 <span class="dv">9443</span> Olive Blvd, St. Louis, Missouri <span class="dv">63132</span>        <span class="dv">1</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb6-13" data-line-number="13"> <span class="dv">9</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd, St. Louis, MO <span class="dv">63108</span>             <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="dv">10</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave, St. Louis, MO <span class="dv">63108</span>         <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co"># … with 20 more rows</span></a></code></pre></div>
<p>Some problems should already be apparent. For instance, Cafe Mouchi uses the full word for “Boulevard” while the entry for Blue Ocean uses the proper abbreviation “Blvd”. For Drunken Fish, the suite number is listed both using the pound sign (“#”) as well as with the word “Suite”. Finally, some of the entries including for BaiKu and I Love Mr Sushi use the full name for “Missouri” while the rest use the proper two-letter abbreviation “MO”. Finally, the Drunk Fish - Ballpark Village uses the “zip+4” format as opposed to the remainder of the addresses visible, which contain only the five digit zip-code.</p>
<p>Some of the other entries have additional issues. For example, Sushi Koi has its address fully capitalized:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1<span class="op">$</span>address[[<span class="dv">22</span>]]</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">[<span class="dv">1</span>] <span class="st">"4 N EUCLID AVE, SAINT LOUIS, MO 63108"</span></a></code></pre></div>
<p>Similarly, Wasabi Sushi Bar has its address fully capitalized, but the prefix direction “SOUTH” appears as a word rather than the proper “S”:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1<span class="op">$</span>address[[<span class="dv">30</span>]]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">[<span class="dv">1</span>] <span class="st">"16 SOUTH CENTRAL AVE, CLAYTON, MISSOURI 63105"</span></a></code></pre></div>
<p>This vignette will walk through the process of addressing these issues.</p>
</div>
<div id="omnibus-parsing-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#omnibus-parsing-functionality" class="anchor"></a>Omnibus Parsing Functionality</h2>
<p>The <code>postmastr</code> package has a single high-level function for parsing, <code><a href="../reference/pm_parse.html">pm_parse()</a></code>, which wraps all of preparatory, parsing, and reconstruction functions into a single call. This can be used if the problem-space is exceptionally well defined - all dictionaries need to be created ahead of time, so you must know what dictionary elements are necessary. This may be possible for you if you consistently work with specific data sources and have a good understanding what cities, states, and other elements of the grammar are present. If you are not sure what dictionary elements are needed, you will need to use the workflow illustrated below to develop these objects.</p>
<p>For the <code>sushi1</code> data, the required dictionaries are:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>dirs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"directional"</span>, <span class="dt">filter =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"N"</span>, <span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"W"</span>), <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>mo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">filter =</span> <span class="st">"MO"</span>, <span class="dt">case =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"title"</span>, <span class="st">"upper"</span>), <span class="dt">locale =</span> <span class="st">"us"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="op">&gt;</span><span class="st"> </span>cities &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_append.html">pm_append</a></span>(<span class="dt">type =</span> <span class="st">"city"</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="op">+</span><span class="st">                       </span><span class="dt">input =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Brentwood"</span>, <span class="st">"Clayton"</span>, <span class="st">"CLAYTON"</span>, <span class="st">"Maplewood"</span>, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="op">+</span><span class="st">                                 "St. Louis"</span>, <span class="st">"SAINT LOUIS"</span>, <span class="st">"Webster Groves"</span>),</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="op">+</span><span class="st">                       </span><span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Clayton"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"St. Louis"</span>, <span class="ot">NA</span>))</a></code></pre></div>
<p>Once those dictionaries are built, we can parse the data. The <code>input</code> argument is used to define how the address data are structured, and <code>output</code> is used to specify what type of output you receive.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="op">+</span><span class="st">   </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(name <span class="op">!=</span><span class="st"> "Drunken Fish - Ballpark Village"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="op">+</span><span class="st">   </span><span class="kw"><a href="../reference/pm_parse.html">pm_parse</a></span>(<span class="dt">input =</span> <span class="st">"full"</span>, <span class="dt">address =</span> <span class="st">"address"</span>, <span class="dt">output =</span> <span class="st">"full"</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="op">+</span><span class="st">          </span><span class="dt">dir_dict =</span> dirs, <span class="dt">city_dict =</span> cities, <span class="dt">state_dict =</span> mo)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co"># A tibble: 27 x 4</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">   name                            address                                        visit    pm.address                                  </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                          </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                       </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st"> </span><span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St, St. Louis, Missouri <span class="dv">63103</span>       <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">3407</span> Olive St St. Louis MO <span class="dv">63103</span>            </a>
<a class="sourceLine" id="cb10-9" data-line-number="9"> <span class="dv">2</span> Blue Ocean Restaurant           <span class="dv">6335</span> Delmar Blvd, St. Louis, MO <span class="dv">63112</span>          <span class="dv">10</span><span class="op">/</span><span class="dv">26</span><span class="op">/</span><span class="dv">18</span> <span class="dv">6335</span> Delmar Blvd St. Louis MO <span class="dv">63112</span>         </a>
<a class="sourceLine" id="cb10-10" data-line-number="10"> <span class="dv">3</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard, St. Louis, MO <span class="dv">63118</span>    <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> <span class="dv">3221</span> S Grand Blvd St. Louis MO <span class="dv">63118</span>        </a>
<a class="sourceLine" id="cb10-11" data-line-number="11"> <span class="dv">4</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza, St. Louis, MO <span class="dv">63108</span>          <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1</span> Maryland Plz St. Louis MO <span class="dv">63108</span>           </a>
<a class="sourceLine" id="cb10-12" data-line-number="12"> <span class="dv">5</span> I Love Mr Sushi                 <span class="dv">9443</span> Olive Blvd, St. Louis, Missouri <span class="dv">63132</span>     <span class="dv">1</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">9443</span> Olive Blvd St. Louis MO <span class="dv">63132</span>          </a>
<a class="sourceLine" id="cb10-13" data-line-number="13"> <span class="dv">6</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd, St. Louis, MO <span class="dv">63108</span>          <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4949</span> W Pine Blvd St. Louis MO <span class="dv">63108</span>         </a>
<a class="sourceLine" id="cb10-14" data-line-number="14"> <span class="dv">7</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave, St. Louis, MO <span class="dv">63108</span>      <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3674</span> Forest Park Ave St. Louis MO <span class="dv">63108</span>     </a>
<a class="sourceLine" id="cb10-15" data-line-number="15"> <span class="dv">8</span> Mizu Sushi Bar                  <span class="dv">1013</span> Washington Avenue, St. Louis, MO <span class="dv">63101</span>    <span class="dv">9</span><span class="op">/</span><span class="dv">12</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1013</span> Washington Ave St. Louis MO <span class="dv">63101</span>      </a>
<a class="sourceLine" id="cb10-16" data-line-number="16"> <span class="dv">9</span> Robata Maplewood                <span class="dv">7260</span> Manchester Road, Maplewood, MO <span class="dv">63143</span>      <span class="dv">11</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">7260</span> Manchester Rd Maplewood MO <span class="dv">63143</span>       </a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="dv">10</span> SanSai Japanese Grill Maplewood <span class="dv">1803</span> Maplewood Commons Dr, St. Louis, MO <span class="dv">63143</span> <span class="dv">2</span><span class="op">/</span><span class="dv">14</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1803</span> Maplewood Commons Dr St. Louis MO <span class="dv">63143</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co"># … with 17 more rows</span></a></code></pre></div>
<p>We can limit our output to just the house and street data:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="op">+</span><span class="st">   </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(name <span class="op">!=</span><span class="st"> "Drunken Fish - Ballpark Village"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="op">+</span><span class="st">   </span><span class="kw"><a href="../reference/pm_parse.html">pm_parse</a></span>(<span class="dt">input =</span> <span class="st">"full"</span>, <span class="dt">address =</span> <span class="st">"address"</span>, <span class="dt">output =</span> <span class="st">"short"</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="op">+</span><span class="st">          </span><span class="dt">dir_dict =</span> dirs, <span class="dt">city_dict =</span> cities, <span class="dt">state_dict =</span> mo)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># A tibble: 27 x 4</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">   name                            address                                        visit    pm.address               </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                          </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                    </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st"> </span><span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St, St. Louis, Missouri <span class="dv">63103</span>       <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">3407</span> Olive St            </a>
<a class="sourceLine" id="cb11-9" data-line-number="9"> <span class="dv">2</span> Blue Ocean Restaurant           <span class="dv">6335</span> Delmar Blvd, St. Louis, MO <span class="dv">63112</span>          <span class="dv">10</span><span class="op">/</span><span class="dv">26</span><span class="op">/</span><span class="dv">18</span> <span class="dv">6335</span> Delmar Blvd         </a>
<a class="sourceLine" id="cb11-10" data-line-number="10"> <span class="dv">3</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard, St. Louis, MO <span class="dv">63118</span>    <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> <span class="dv">3221</span> S Grand Blvd        </a>
<a class="sourceLine" id="cb11-11" data-line-number="11"> <span class="dv">4</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza, St. Louis, MO <span class="dv">63108</span>          <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1</span> Maryland Plz           </a>
<a class="sourceLine" id="cb11-12" data-line-number="12"> <span class="dv">5</span> I Love Mr Sushi                 <span class="dv">9443</span> Olive Blvd, St. Louis, Missouri <span class="dv">63132</span>     <span class="dv">1</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">9443</span> Olive Blvd          </a>
<a class="sourceLine" id="cb11-13" data-line-number="13"> <span class="dv">6</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd, St. Louis, MO <span class="dv">63108</span>          <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4949</span> W Pine Blvd         </a>
<a class="sourceLine" id="cb11-14" data-line-number="14"> <span class="dv">7</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave, St. Louis, MO <span class="dv">63108</span>      <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3674</span> Forest Park Ave     </a>
<a class="sourceLine" id="cb11-15" data-line-number="15"> <span class="dv">8</span> Mizu Sushi Bar                  <span class="dv">1013</span> Washington Avenue, St. Louis, MO <span class="dv">63101</span>    <span class="dv">9</span><span class="op">/</span><span class="dv">12</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1013</span> Washington Ave      </a>
<a class="sourceLine" id="cb11-16" data-line-number="16"> <span class="dv">9</span> Robata Maplewood                <span class="dv">7260</span> Manchester Road, Maplewood, MO <span class="dv">63143</span>      <span class="dv">11</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">7260</span> Manchester Rd       </a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="dv">10</span> SanSai Japanese Grill Maplewood <span class="dv">1803</span> Maplewood Commons Dr, St. Louis, MO <span class="dv">63143</span> <span class="dv">2</span><span class="op">/</span><span class="dv">14</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1803</span> Maplewood Commons Dr</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co"># … with 17 more rows</span></a></code></pre></div>
<p>We can also add the city, state, and postal code data as separate columns:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="op">+</span><span class="st">   </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(name <span class="op">!=</span><span class="st"> "Drunken Fish - Ballpark Village"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="op">+</span><span class="st">   </span><span class="kw"><a href="../reference/pm_parse.html">pm_parse</a></span>(<span class="dt">input =</span> <span class="st">"full"</span>, <span class="dt">address =</span> <span class="st">"address"</span>, <span class="dt">output =</span> <span class="st">"short"</span>, <span class="dt">keep_parsed =</span> <span class="st">"limited"</span>, </a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="op">+</span><span class="st">          </span><span class="dt">dir_dict =</span> dirs, <span class="dt">city_dict =</span> cities, <span class="dt">state_dict =</span> mo)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># A tibble: 27 x 8</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">   name                            address                                        visit    pm.address                pm.city   pm.state pm.zip pm.zip4</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                          </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st"> </span><span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St, St. Louis, Missouri <span class="dv">63103</span>       <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">3407</span> Olive St             St. Louis MO       <span class="dv">63103</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-9" data-line-number="9"> <span class="dv">2</span> Blue Ocean Restaurant           <span class="dv">6335</span> Delmar Blvd, St. Louis, MO <span class="dv">63112</span>          <span class="dv">10</span><span class="op">/</span><span class="dv">26</span><span class="op">/</span><span class="dv">18</span> <span class="dv">6335</span> Delmar Blvd          St. Louis MO       <span class="dv">63112</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-10" data-line-number="10"> <span class="dv">3</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard, St. Louis, MO <span class="dv">63118</span>    <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> <span class="dv">3221</span> S Grand Blvd         St. Louis MO       <span class="dv">63118</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-11" data-line-number="11"> <span class="dv">4</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza, St. Louis, MO <span class="dv">63108</span>          <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1</span> Maryland Plz            St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-12" data-line-number="12"> <span class="dv">5</span> I Love Mr Sushi                 <span class="dv">9443</span> Olive Blvd, St. Louis, Missouri <span class="dv">63132</span>     <span class="dv">1</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">9443</span> Olive Blvd           St. Louis MO       <span class="dv">63132</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-13" data-line-number="13"> <span class="dv">6</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd, St. Louis, MO <span class="dv">63108</span>          <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4949</span> W Pine Blvd          St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-14" data-line-number="14"> <span class="dv">7</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave, St. Louis, MO <span class="dv">63108</span>      <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3674</span> Forest Park Ave      St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-15" data-line-number="15"> <span class="dv">8</span> Mizu Sushi Bar                  <span class="dv">1013</span> Washington Avenue, St. Louis, MO <span class="dv">63101</span>    <span class="dv">9</span><span class="op">/</span><span class="dv">12</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1013</span> Washington Ave       St. Louis MO       <span class="dv">63101</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-16" data-line-number="16"> <span class="dv">9</span> Robata Maplewood                <span class="dv">7260</span> Manchester Road, Maplewood, MO <span class="dv">63143</span>      <span class="dv">11</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">7260</span> Manchester Rd        Maplewood MO       <span class="dv">63143</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="dv">10</span> SanSai Japanese Grill Maplewood <span class="dv">1803</span> Maplewood Commons Dr, St. Louis, MO <span class="dv">63143</span> <span class="dv">2</span><span class="op">/</span><span class="dv">14</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1803</span> Maplewood Commons Dr St. Louis MO       <span class="dv">63143</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co"># … with 17 more rows</span></a></code></pre></div>
</div>
<div id="the-postmastr-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#the-postmastr-workflow" class="anchor"></a>The <code>postmastr</code> Workflow</h2>
<p>If you do not have a strong sense of the problem-space you are confronted with, and therefore do not know exactly what is needed for dictionaries, <code>postmastr</code> has a full-featured workflow for step-by-step parsing of street addresses.</p>
<div id="order-of-operations-in-postmastr" class="section level3">
<h3 class="hasAnchor">
<a href="#order-of-operations-in-postmastr" class="anchor"></a>Order of Operations in <code>postmastr</code>
</h3>
<p><code>postmast</code>’s functionality rests on an order of operations that <em>must</em> be followed to ensure correct parsing:</p>
<ol style="list-style-type: decimal">
<li>prep</li>
<li>postal code</li>
<li>state</li>
<li>city</li>
<li>unit</li>
<li>house number</li>
<li>ranged house number</li>
<li>fractional house number</li>
<li>house suffix</li>
<li>street directionals</li>
<li>street suffix</li>
<li>street name</li>
<li>reconstruct</li>
</ol>
<p>If no street address in the given data set contains one of the grammatical elements (for example, if none of the addresses contain units), the associated functions in the workflow can be skipped. For “short” addresses that do not include cities, states, or postal codes, the order of operations should be:</p>
<ol style="list-style-type: decimal">
<li>prep</li>
<li>unit</li>
<li>house number</li>
<li>ranged house number</li>
<li>fractional house number</li>
<li>house suffix</li>
<li>street directionals</li>
<li>street suffix</li>
<li>street name</li>
<li>reconstruct</li>
</ol>
</div>
<div id="prep" class="section level3">
<h3 class="hasAnchor">
<a href="#prep" class="anchor"></a>Prep</h3>
<p>There are two initial preparatory steps that <em>must</em> be taken with these data. First, we want to ensure that they have a unique identification number for each row (to preserve the original sort order; <code>pm.id</code>) as well as a unique identification number for each <em>unique</em> street address string (<code>pm.uid</code>). These can both be applied using <code>pm.identify()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_identify.html">pm_identify</a></span>(sushi1, <span class="dt">var =</span> <span class="st">"address"</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>sushi1</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># A tibble: 30 x 5</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">   pm.id pm.uid name                            address                                           visit   </a>
<a class="sourceLine" id="cb13-5" data-line-number="5">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                             </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St, St. Louis, Missouri <span class="dv">63103</span>          <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"> <span class="dv">2</span>     <span class="dv">2</span>      <span class="dv">2</span> Blue Ocean Restaurant           <span class="dv">6335</span> Delmar Blvd, St. Louis, MO <span class="dv">63112</span>             <span class="dv">10</span><span class="op">/</span><span class="dv">26</span><span class="op">/</span><span class="dv">18</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"> <span class="dv">3</span>     <span class="dv">3</span>      <span class="dv">3</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard, St. Louis, MO <span class="dv">63118</span>       <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"> <span class="dv">4</span>     <span class="dv">4</span>      <span class="dv">4</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave <span class="co">#104, St. Louis, MO 63102-1719      4/28/18 </span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"> <span class="dv">5</span>     <span class="dv">5</span>      <span class="dv">5</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span>, St. Louis, MO <span class="dv">63102-1719</span> <span class="dv">5</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb13-11" data-line-number="11"> <span class="dv">6</span>     <span class="dv">6</span>      <span class="dv">5</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Ballpark Village <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span>, St. Louis, MO <span class="dv">63102-1719</span> <span class="dv">8</span><span class="op">/</span><span class="dv">7</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb13-12" data-line-number="12"> <span class="dv">7</span>     <span class="dv">7</span>      <span class="dv">6</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza, St. Louis, MO <span class="dv">63108</span>             <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb13-13" data-line-number="13"> <span class="dv">8</span>     <span class="dv">8</span>      <span class="dv">7</span> I Love Mr Sushi                 <span class="dv">9443</span> Olive Blvd, St. Louis, Missouri <span class="dv">63132</span>        <span class="dv">1</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb13-14" data-line-number="14"> <span class="dv">9</span>     <span class="dv">9</span>      <span class="dv">8</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd, St. Louis, MO <span class="dv">63108</span>             <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span> </a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="dv">10</span>    <span class="dv">10</span>      <span class="dv">9</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave, St. Louis, MO <span class="dv">63108</span>         <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>  </a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co"># … with 20 more rows</span></a></code></pre></div>
<p>Notice that the Drunken Fish has three different unique identifiers applied for <code>pm.uid</code> - two for the Ballpark Village location based on how the suite number is indicated and one for the Central West End location. Since address data are often numerous, <code>postmastr</code> is designed to operate on unique street address strings rather than the full original data set to improve efficiency. We’ll create our minimal <code>postmastr</code> object using <code>pm.prep()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_prep.html">pm_prep</a></span>(sushi1, <span class="dt">var =</span> <span class="st">"address"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>sushi1_min</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># A tibble: 24 x 2</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">   pm.uid pm.address                                     </a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                          </span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span> Olive St St. Louis Missouri <span class="dv">63103</span>         </a>
<a class="sourceLine" id="cb14-7" data-line-number="7"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">6335</span> Delmar Blvd St. Louis MO <span class="dv">63112</span>            </a>
<a class="sourceLine" id="cb14-8" data-line-number="8"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">3221</span> S Grand Boulevard St. Louis MO <span class="dv">63118</span>      </a>
<a class="sourceLine" id="cb14-9" data-line-number="9"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">601</span> Clark Ave <span class="co">#104 St. Louis MO 63102-1719     </span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span> St. Louis MO <span class="dv">63102-1719</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1</span> Maryland Plaza St. Louis MO <span class="dv">63108</span>            </a>
<a class="sourceLine" id="cb14-12" data-line-number="12"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">9443</span> Olive Blvd St. Louis Missouri <span class="dv">63132</span>       </a>
<a class="sourceLine" id="cb14-13" data-line-number="13"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">4949</span> W Pine Blvd St. Louis MO <span class="dv">63108</span>            </a>
<a class="sourceLine" id="cb14-14" data-line-number="14"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">3674</span> Forest Park Ave St. Louis MO <span class="dv">63108</span>        </a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">1013</span> Washington Avenue St. Louis MO <span class="dv">63101</span>      </a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co"># … with 14 more rows</span></a></code></pre></div>
<p>Notice that all extraneous information has been removed, and that there are now only 24 rows instead of the original 30.</p>
</div>
<div id="postal-codes" class="section level3">
<h3 class="hasAnchor">
<a href="#postal-codes" class="anchor"></a>Postal Codes</h3>
<p>Once we have our data prepared, we can begin working our way down the order of operations list. To see if is possible to skip a step, we should first use the appropriate <code>pm_any_</code> function. With the <code>sushi1_min</code> data, it will return <code>TRUE</code> because postal codes are present in the data:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_any_postal</span>(sushi1_min)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">[<span class="dv">1</span>] <span class="ot">TRUE</span></a></code></pre></div>
<p>We can also use <code>pm_all_</code> functions to determine whether all of the addresses have a postal code:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_all_postal</span>(sushi1_min)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">[<span class="dv">1</span>] <span class="ot">TRUE</span></a></code></pre></div>
<p>If this returned a <code>FALSE</code> result, we would want to use <code>pm_has</code> and <code>pm_no_</code> functions to explore whether postal codes are not being detected because they (a) actually do not exist or (b) are not being found because they are mis-formatted. Since we get a <code>TRUE</code> result, we can move on to parsing. If <code>pm_parse_postal()</code> detects the presence of carrier routes (the four-digit additions to the typical five-digit zip-codes), it will parse those as well so that two postal code columns (<code>pm.zip</code> and <code>pm.zip4</code>) are returned:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1_min &lt;-<span class="st"> </span><span class="kw">pm_parse_postal</span>(sushi1_min)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>sushi1_min</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># A tibble: 24 x 4</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">   pm.uid pm.address                           pm.zip pm.zip4</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span> Olive St St. Louis Missouri     <span class="dv">63103</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-7" data-line-number="7"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">6335</span> Delmar Blvd St. Louis MO        <span class="dv">63112</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-8" data-line-number="8"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">3221</span> S Grand Boulevard St. Louis MO  <span class="dv">63118</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-9" data-line-number="9"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">601</span> Clark Ave <span class="co">#104 St. Louis MO      63102  1719   </span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span> St. Louis MO <span class="dv">63102</span>  <span class="dv">1719</span>   </a>
<a class="sourceLine" id="cb17-11" data-line-number="11"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1</span> Maryland Plaza St. Louis MO        <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-12" data-line-number="12"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">9443</span> Olive Blvd St. Louis Missouri   <span class="dv">63132</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-13" data-line-number="13"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">4949</span> W Pine Blvd St. Louis MO        <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-14" data-line-number="14"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">3674</span> Forest Park Ave St. Louis MO    <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">1013</span> Washington Avenue St. Louis MO  <span class="dv">63101</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co"># … with 14 more rows</span></a></code></pre></div>
<p>Had no carrier routes been present, these data would have been returned with only the <code>pm.zip</code> column. Note that <code>pm_parse_postal()</code> also updates the <code>pm.address</code> column and removes any postal codes that have been identified. This facilitates additional parsing in subsequent steps.</p>
</div>
<div id="states" class="section level3">
<h3 class="hasAnchor">
<a href="#states" class="anchor"></a>States</h3>
<p>To parse the cities out of <code>pm.address</code>, we’ll start by creating a state-level dictionary object that contains only references to Missouri since we don’t have data outside of that state:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>moDict &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">locale =</span> <span class="st">"us"</span>, <span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">filter =</span> <span class="st">"MO"</span>, <span class="dt">case =</span> <span class="st">"title"</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>moDict</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co"># A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  state.output state.input</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="dv">1</span> MO           MO         </a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="dv">2</span> MO           Missouri   </a></code></pre></div>
<p>With our dictionary created in the object <code>moDict</code>, we can use that to test whether state names or abbreviations are found at the end of our address string with <code>pm_any_state()</code> and <code>pm_all_state()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_any_state</span>(sushi1_min, <span class="dt">dictionary =</span> moDict)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">[<span class="dv">1</span>] <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_all_state</span>(sushi1_min, <span class="dt">dictionary =</span> moDict)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">[<span class="dv">1</span>] <span class="ot">FALSE</span></a></code></pre></div>
<p>These results indicate that our dictionary is returning matches, but that our list of possible inputs is not complete. We can explore the un-matched streets with <code>pm_no_state()</code> to determining whether these observations (a) actually do not contain states or (b) are not being matched because an entry is missing from our dictionary:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_no_state</span>(sushi1_min, <span class="dt">dictionary =</span> moDict)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co"># A tibble: 1 x 4</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  pm.uid pm.address                            pm.zip pm.zip4</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                                 </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="dv">1</span>     <span class="dv">24</span> <span class="dv">16</span> SOUTH CENTRAL AVE CLAYTON MISSOURI <span class="dv">63105</span>  <span class="ot">NA</span>  </a></code></pre></div>
<p>Our dictionary does not contain <code>MISSOURI</code>, only <code>Missouri</code>, so we’ll need to add that option. We can use <code>case = c("title", "upper")</code> to do this:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>moDict &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_dictionary.html">pm_dictionary</a></span>(<span class="dt">locale =</span> <span class="st">"us"</span>, <span class="dt">type =</span> <span class="st">"state"</span>, <span class="dt">filter =</span> <span class="st">"MO"</span>, <span class="dt">case =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"title"</span>, <span class="st">"upper"</span>))</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>moDict</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  state.output state.input</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">      </span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="dv">1</span> MO           MO         </a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="dv">2</span> MO           Missouri   </a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="dv">3</span> MO           MISSOURI   </a></code></pre></div>
<p>For more complex mis-matches, we would want to use <code><a href="../reference/pm_append.html">pm_append()</a></code> to construct an appendix and then re-build our dictionary with that appendix included. We can verify that our dictionary is now complete by repeating our use of <code>pm_all_state()</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_all_state</span>(sushi1_min, <span class="dt">dictionary =</span> moDict)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">[<span class="dv">1</span>] <span class="ot">TRUE</span></a></code></pre></div>
<p>With a <code>TRUE</code> result, we are ready to parse state names and abbreviations out of our data:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1_min &lt;-<span class="st"> </span><span class="kw">pm_parse_state</span>(sushi1_min, <span class="dt">dictionary =</span> moDict)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>sushi1_min</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co"># A tibble: 24 x 5</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">   pm.uid pm.address                        pm.state pm.zip pm.zip4</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                             </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span> Olive St St. Louis           MO       <span class="dv">63103</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-7" data-line-number="7"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">6335</span> Delmar Blvd St. Louis        MO       <span class="dv">63112</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-8" data-line-number="8"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">3221</span> S Grand Boulevard St. Louis  MO       <span class="dv">63118</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-9" data-line-number="9"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">601</span> Clark Ave <span class="co">#104 St. Louis      MO       63102  1719   </span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span> St. Louis MO       <span class="dv">63102</span>  <span class="dv">1719</span>   </a>
<a class="sourceLine" id="cb23-11" data-line-number="11"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1</span> Maryland Plaza St. Louis        MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-12" data-line-number="12"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">9443</span> Olive Blvd St. Louis         MO       <span class="dv">63132</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-13" data-line-number="13"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">4949</span> W Pine Blvd St. Louis        MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-14" data-line-number="14"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">3674</span> Forest Park Ave St. Louis    MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">1013</span> Washington Avenue St. Louis  MO       <span class="dv">63101</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co"># … with 14 more rows</span></a></code></pre></div>
<p>If we inspect this object, we’ll see that <code>pm.state</code> contains the state abbreviation for Missouri in all cases. As with postal codes, the city names have been removed from <code>pm.address</code> to facilitate the next phase in parsing.</p>
</div>
<div id="cities" class="section level3">
<h3 class="hasAnchor">
<a href="#cities" class="anchor"></a>Cities</h3>
<p>The workflow for cities is similar. Two options exist for American cities - you can either create a full list of cities by state using <code><a href="../reference/pm_dictionary.html">pm_dictionary()</a></code> (useful if you are not sure which cities appear in the data) or use <code><a href="../reference/pm_append.html">pm_append()</a></code> on its own to create an appendix (faster if you know that there are a limited number of cities). This appendix for cities can be used on its own. We’ll choose this second option:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">cityDict &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_append.html">pm_append</a></span>(<span class="dt">type =</span> <span class="st">"city"</span>,</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">                      <span class="dt">input =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Brentwood"</span>, <span class="st">"Clayton"</span>, <span class="st">"Maplewood"</span>, <span class="st">"St. Louis"</span>, <span class="st">"Webster Groves"</span>))</a></code></pre></div>
<p>We’ll then use <code>pm_any_city()</code> and <code>pm_all_city()</code> to verify that our dictionary is working and complete:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_any_city</span>(sushi1_min, <span class="dt">dictionary =</span> cityDict)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">[<span class="dv">1</span>] <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_all_city</span>(sushi1_min, <span class="dt">dictionary =</span> cityDict)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">[<span class="dv">1</span>] <span class="ot">FALSE</span></a></code></pre></div>
<p>As with the state data, we can use <code>pm_no_city()</code> to identify why our dictionary is incomplete (or verify that some addresses do not contain cities):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_no_city</span>(sushi1_min, <span class="dt">dictionary =</span> cityDict)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co"># A tibble: 2 x 5</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3">  pm.uid pm.address                   pm.state pm.zip pm.zip4</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                        </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="dv">1</span>     <span class="dv">17</span> <span class="dv">4</span> N EUCLID AVE SAINT LOUIS   MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="dv">2</span>     <span class="dv">24</span> <span class="dv">16</span> SOUTH CENTRAL AVE CLAYTON MO       <span class="dv">63105</span>  <span class="ot">NA</span>    </a></code></pre></div>
<p>There are two city names in all upper-case. We’ll re-create our dictionary, adding both <code>"SAINT LOUIS"</code> and <code>"CLAYTON"</code> as well as specifying an <code>output</code> vector that is <code>NA</code> for all the correct cities but includes entries for our two incorrectly formatted cities and verify using <code>pm_all_city()</code> that our dictionary is now complete:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>cityDict &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_append.html">pm_append</a></span>(<span class="dt">type =</span> <span class="st">"city"</span>,</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="op">+</span><span class="st">                       </span><span class="dt">input =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Brentwood"</span>, <span class="st">"Clayton"</span>, <span class="st">"CLAYTON"</span>, <span class="st">"Maplewood"</span>, </a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="op">+</span><span class="st">                                 "St. Louis"</span>, <span class="st">"SAINT LOUIS"</span>, <span class="st">"Webster Groves"</span>),</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="op">+</span><span class="st">                       </span><span class="dt">output =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Clayton"</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"St. Louis"</span>, <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="op">&gt;</span><span class="st"> </span><span class="kw">pm_all_city</span>(sushi1_min, <span class="dt">dictionary =</span> cityDict)</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">[<span class="dv">1</span>] <span class="ot">TRUE</span></a></code></pre></div>
<p>We can now move on to parsing using <code>pm_parse_city()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi1_min &lt;-<span class="st"> </span><span class="kw">pm_parse_city</span>(sushi1_min, <span class="dt">dictionary =</span> cityDict)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>sushi1_min</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co"># A tibble: 24 x 6</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">   pm.uid pm.address              pm.city   pm.state pm.zip pm.zip4</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                   </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">  </span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span> Olive St           St. Louis MO       <span class="dv">63103</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-7" data-line-number="7"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">6335</span> Delmar Blvd        St. Louis MO       <span class="dv">63112</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-8" data-line-number="8"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">3221</span> S Grand Boulevard  St. Louis MO       <span class="dv">63118</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-9" data-line-number="9"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">601</span> Clark Ave <span class="co">#104      St. Louis MO       63102  1719   </span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">601</span> Clark Ave Suite <span class="dv">104</span> St. Louis MO       <span class="dv">63102</span>  <span class="dv">1719</span>   </a>
<a class="sourceLine" id="cb28-11" data-line-number="11"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1</span> Maryland Plaza        St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-12" data-line-number="12"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">9443</span> Olive Blvd         St. Louis MO       <span class="dv">63132</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-13" data-line-number="13"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">4949</span> W Pine Blvd        St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-14" data-line-number="14"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">3674</span> Forest Park Ave    St. Louis MO       <span class="dv">63108</span>  <span class="ot">NA</span>     </a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">1013</span> Washington Avenue  St. Louis MO       <span class="dv">63101</span>  <span class="ot">NA</span> </a></code></pre></div>
<p>The column <code>pm.city</code> has been added to our data set and city names have been parsed as well as standardized.</p>
</div>
<div id="units" class="section level3">
<h3 class="hasAnchor">
<a href="#units" class="anchor"></a>Units</h3>
<p><strong>This functionality is not enabled yet.</strong></p>
</div>
<div id="house-numbers" class="section level3">
<h3 class="hasAnchor">
<a href="#house-numbers" class="anchor"></a>House Numbers</h3>
<p>Since the example data do not contain fractional addresses or house suffix values, parsing them is straightforward (dealing with less common street addresses will be the subject of an additional vignette). We’ll use an abbreviated version of the sushi data that do not contain city, state, or postal code data. These are sushi restaurants located within the City of St. Louis proper:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>postmastr<span class="op">::</span>sushi2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="op">+</span><span class="st">   </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(name <span class="op">!=</span><span class="st"> "Drunken Fish - Ballpark Village"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="op">+</span><span class="st">   </span><span class="kw"><a href="../reference/pm_identify.html">pm_identify</a></span>(<span class="dt">var =</span> address) -&gt;<span class="st"> </span>sushi2</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="er">&gt;</span><span class="st"> </span>sushi2_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_prep.html">pm_prep</a></span>(sushi2, <span class="dt">var =</span> address)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="er">&gt;</span><span class="st"> </span>sushi2_min</a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="co"># A tibble: 11 x 2</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9">   pm.uid pm.address            </a>
<a class="sourceLine" id="cb29-10" data-line-number="10">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                 </span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span> Olive St         </a>
<a class="sourceLine" id="cb29-12" data-line-number="12"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">3221</span> S Grand Boulevard</a>
<a class="sourceLine" id="cb29-13" data-line-number="13"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">1</span> Maryland Plaza      </a>
<a class="sourceLine" id="cb29-14" data-line-number="14"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">4949</span> W Pine Blvd      </a>
<a class="sourceLine" id="cb29-15" data-line-number="15"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">3674</span> Forest Park Ave  </a>
<a class="sourceLine" id="cb29-16" data-line-number="16"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1013</span> Washington Avenue</a>
<a class="sourceLine" id="cb29-17" data-line-number="17"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">3043</span> Olive St         </a>
<a class="sourceLine" id="cb29-18" data-line-number="18"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">308</span> N Euclid Ave      </a>
<a class="sourceLine" id="cb29-19" data-line-number="19"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">910</span> Olive St          </a>
<a class="sourceLine" id="cb29-20" data-line-number="20"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">910</span> Olive Street      </a>
<a class="sourceLine" id="cb29-21" data-line-number="21"><span class="dv">11</span>     <span class="dv">11</span> <span class="dv">4</span> N EUCLID AVE   </a></code></pre></div>
<p>Our next task in the order of operations is to parse out house numbers. We do this with <code><a href="../reference/pm_house_parse.html">pm_house_parse()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_house_parse.html">pm_house_parse</a></span>(sushi2_min)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_min</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co"># A tibble: 11 x 3</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">   pm.uid pm.address        pm.house</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">             </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">   </span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> Olive St          <span class="dv">3407</span>    </a>
<a class="sourceLine" id="cb30-8" data-line-number="8"> <span class="dv">2</span>      <span class="dv">2</span> S Grand Boulevard <span class="dv">3221</span>    </a>
<a class="sourceLine" id="cb30-9" data-line-number="9"> <span class="dv">3</span>      <span class="dv">3</span> Maryland Plaza    <span class="dv">1</span>       </a>
<a class="sourceLine" id="cb30-10" data-line-number="10"> <span class="dv">4</span>      <span class="dv">4</span> W Pine Blvd       <span class="dv">4949</span>    </a>
<a class="sourceLine" id="cb30-11" data-line-number="11"> <span class="dv">5</span>      <span class="dv">5</span> Forest Park Ave   <span class="dv">3674</span>    </a>
<a class="sourceLine" id="cb30-12" data-line-number="12"> <span class="dv">6</span>      <span class="dv">6</span> Washington Avenue <span class="dv">1013</span>    </a>
<a class="sourceLine" id="cb30-13" data-line-number="13"> <span class="dv">7</span>      <span class="dv">7</span> Olive St          <span class="dv">3043</span>    </a>
<a class="sourceLine" id="cb30-14" data-line-number="14"> <span class="dv">8</span>      <span class="dv">8</span> N Euclid Ave      <span class="dv">308</span>     </a>
<a class="sourceLine" id="cb30-15" data-line-number="15"> <span class="dv">9</span>      <span class="dv">9</span> Olive St          <span class="dv">910</span>     </a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="dv">10</span>     <span class="dv">10</span> Olive Street      <span class="dv">910</span>     </a>
<a class="sourceLine" id="cb30-17" data-line-number="17"><span class="dv">11</span>     <span class="dv">11</span> N EUCLID AVE      <span class="dv">4</span>   </a></code></pre></div>
<p>There is no dictionary for this step - the first word of any address will be parsed out so long as it contains at least some numbers. If you house number contains a range (<code>123-125 Main St</code>) or fractional value (<code>123 1/2 Main St</code>), there are a separate set of functions for both <code>pm_houseRange_</code> and <code>pm_houseFrac_</code> for dealing with these special cases.</p>
</div>
<div id="street-prefix-and-suffix-data" class="section level3">
<h3 class="hasAnchor">
<a href="#street-prefix-and-suffix-data" class="anchor"></a>Street Prefix and Suffix Data</h3>
<p>Our addresses have two types of prefix and suffix data. There are directionals, like the “south” in <code>S Grand Boulevard</code>, and the suffix value, which is “Boulevard”. The United States Postal Services prefers abbreviations for both directionals and suffix values, and so <code>postmastr</code> returns the preferred abbreviations whenever full names are found. We can parse out the directionals first with <code><a href="../reference/pm_streetDir_parse.html">pm_streetDir_parse()</a></code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_streetDir_parse.html">pm_streetDir_parse</a></span>(sushi2_min, <span class="dt">dictionary =</span> dirs)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_min</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="co"># A tibble: 11 x 4</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">   pm.uid pm.address        pm.house pm.preDir</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">             </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> Olive St          <span class="dv">3407</span>     <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-8" data-line-number="8"> <span class="dv">2</span>      <span class="dv">2</span> Grand Boulevard   <span class="dv">3221</span>     S        </a>
<a class="sourceLine" id="cb31-9" data-line-number="9"> <span class="dv">3</span>      <span class="dv">3</span> Maryland Plaza    <span class="dv">1</span>        <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-10" data-line-number="10"> <span class="dv">4</span>      <span class="dv">4</span> Pine Blvd         <span class="dv">4949</span>     W        </a>
<a class="sourceLine" id="cb31-11" data-line-number="11"> <span class="dv">5</span>      <span class="dv">5</span> Forest Park Ave   <span class="dv">3674</span>     <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-12" data-line-number="12"> <span class="dv">6</span>      <span class="dv">6</span> Washington Avenue <span class="dv">1013</span>     <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-13" data-line-number="13"> <span class="dv">7</span>      <span class="dv">7</span> Olive St          <span class="dv">3043</span>     <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-14" data-line-number="14"> <span class="dv">8</span>      <span class="dv">8</span> Euclid Ave        <span class="dv">308</span>      N        </a>
<a class="sourceLine" id="cb31-15" data-line-number="15"> <span class="dv">9</span>      <span class="dv">9</span> Olive St          <span class="dv">910</span>      <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="dv">10</span>     <span class="dv">10</span> Olive Street      <span class="dv">910</span>      <span class="ot">NA</span>       </a>
<a class="sourceLine" id="cb31-17" data-line-number="17"><span class="dv">11</span>     <span class="dv">11</span> EUCLID AVE        <span class="dv">4</span>        N  </a></code></pre></div>
<p><code>postmastr</code> will automatically detect both prefix and suffix directionals (i.e. <code>S Grand Boulevard</code> and <code>Grand Boulevard S</code>).</p>
<p>Once directionals have been parsed, we can parse and standardize the street suffix values as well with <code><a href="../reference/pm_streetSuf_parse.html">pm_streetSuf_parse()</a></code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_streetSuf_parse.html">pm_streetSuf_parse</a></span>(sushi2_min)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_min</a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="co"># A tibble: 11 x 5</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">   pm.uid pm.address  pm.house pm.preDir pm.streetSuf</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> Olive       <span class="dv">3407</span>     <span class="ot">NA</span>        St          </a>
<a class="sourceLine" id="cb32-8" data-line-number="8"> <span class="dv">2</span>      <span class="dv">2</span> Grand       <span class="dv">3221</span>     S         Blvd        </a>
<a class="sourceLine" id="cb32-9" data-line-number="9"> <span class="dv">3</span>      <span class="dv">3</span> Maryland    <span class="dv">1</span>        <span class="ot">NA</span>        Plz         </a>
<a class="sourceLine" id="cb32-10" data-line-number="10"> <span class="dv">4</span>      <span class="dv">4</span> Pine        <span class="dv">4949</span>     W         Blvd        </a>
<a class="sourceLine" id="cb32-11" data-line-number="11"> <span class="dv">5</span>      <span class="dv">5</span> Forest Park <span class="dv">3674</span>     <span class="ot">NA</span>        Ave         </a>
<a class="sourceLine" id="cb32-12" data-line-number="12"> <span class="dv">6</span>      <span class="dv">6</span> Washington  <span class="dv">1013</span>     <span class="ot">NA</span>        Ave         </a>
<a class="sourceLine" id="cb32-13" data-line-number="13"> <span class="dv">7</span>      <span class="dv">7</span> Olive       <span class="dv">3043</span>     <span class="ot">NA</span>        St          </a>
<a class="sourceLine" id="cb32-14" data-line-number="14"> <span class="dv">8</span>      <span class="dv">8</span> Euclid      <span class="dv">308</span>      N         Ave         </a>
<a class="sourceLine" id="cb32-15" data-line-number="15"> <span class="dv">9</span>      <span class="dv">9</span> Olive       <span class="dv">910</span>      <span class="ot">NA</span>        St          </a>
<a class="sourceLine" id="cb32-16" data-line-number="16"><span class="dv">10</span>     <span class="dv">10</span> Olive       <span class="dv">910</span>      <span class="ot">NA</span>        St          </a>
<a class="sourceLine" id="cb32-17" data-line-number="17"><span class="dv">11</span>     <span class="dv">11</span> EUCLID      <span class="dv">4</span>        N         Ave   </a></code></pre></div>
<p>If a street has a directional name (i.e. <code>North Ave</code>), the word <code>North</code> will be added back into <code>pm.address</code> after the street suffix is parsed out.</p>
</div>
<div id="street-names" class="section level3">
<h3 class="hasAnchor">
<a href="#street-names" class="anchor"></a>Street Names</h3>
<p>Our final parsing task is to convert whatever remains in <code>pm.address</code> to the street name with <code><a href="../reference/pm_street_parse.html">pm_street_parse()</a></code>. As part of the standardization process, names like <code>Second</code> will be converted to ordinals (i.e. <code>2nd</code>). This creates shorter, more compact output street names. This same standardization functionality allows for optional standardization of commonly misspelled street names as well.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_min &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_street_parse.html">pm_street_parse</a></span>(sushi2_min, <span class="dt">ordinal =</span> <span class="ot">TRUE</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_min</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co"># A tibble: 11 x 5</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5">   pm.uid pm.house pm.preDir pm.street   pm.streetSuf</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">    <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span>      <span class="dv">1</span> <span class="dv">3407</span>     <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb33-8" data-line-number="8"> <span class="dv">2</span>      <span class="dv">2</span> <span class="dv">3221</span>     S         Grand       Blvd        </a>
<a class="sourceLine" id="cb33-9" data-line-number="9"> <span class="dv">3</span>      <span class="dv">3</span> <span class="dv">1</span>        <span class="ot">NA</span>        Maryland    Plz         </a>
<a class="sourceLine" id="cb33-10" data-line-number="10"> <span class="dv">4</span>      <span class="dv">4</span> <span class="dv">4949</span>     W         Pine        Blvd        </a>
<a class="sourceLine" id="cb33-11" data-line-number="11"> <span class="dv">5</span>      <span class="dv">5</span> <span class="dv">3674</span>     <span class="ot">NA</span>        Forest Park Ave         </a>
<a class="sourceLine" id="cb33-12" data-line-number="12"> <span class="dv">6</span>      <span class="dv">6</span> <span class="dv">1013</span>     <span class="ot">NA</span>        Washington  Ave         </a>
<a class="sourceLine" id="cb33-13" data-line-number="13"> <span class="dv">7</span>      <span class="dv">7</span> <span class="dv">3043</span>     <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb33-14" data-line-number="14"> <span class="dv">8</span>      <span class="dv">8</span> <span class="dv">308</span>      N         Euclid      Ave         </a>
<a class="sourceLine" id="cb33-15" data-line-number="15"> <span class="dv">9</span>      <span class="dv">9</span> <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="dv">10</span>     <span class="dv">10</span> <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb33-17" data-line-number="17"><span class="dv">11</span>     <span class="dv">11</span> <span class="dv">4</span>        N         Euclid      Ave   </a></code></pre></div>
<p>The <code>pm_street_</code> family of functions does not have the logical test functions at this time since street names are assumed to be whatever is leftover from the parsing process to this point.</p>
</div>
<div id="putting-it-all-back-together" class="section level3">
<h3 class="hasAnchor">
<a href="#putting-it-all-back-together" class="anchor"></a>Putting It All Back Together</h3>
<p>Once we have parsed data, we add our parsed data back into the source data frame with <code>pm_replae()</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_parsed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_replace.html">pm_replace</a></span>(sushi2_min, <span class="dt">source =</span> sushi2)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_parsed</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co"># A tibble: 15 x 9</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5">   pm.id pm.uid name                            address                visit    pm.house pm.preDir pm.street   pm.streetSuf</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st">  </span><span class="er">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">     </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">       </span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span>     <span class="dv">1</span>      <span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St          <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">3407</span>     <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-8" data-line-number="8"> <span class="dv">2</span>     <span class="dv">2</span>      <span class="dv">2</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> <span class="dv">3221</span>     S         Grand       Blvd        </a>
<a class="sourceLine" id="cb34-9" data-line-number="9"> <span class="dv">3</span>     <span class="dv">3</span>      <span class="dv">3</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza       <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1</span>        <span class="ot">NA</span>        Maryland    Plz         </a>
<a class="sourceLine" id="cb34-10" data-line-number="10"> <span class="dv">4</span>     <span class="dv">4</span>      <span class="dv">4</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd       <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4949</span>     W         Pine        Blvd        </a>
<a class="sourceLine" id="cb34-11" data-line-number="11"> <span class="dv">5</span>     <span class="dv">5</span>      <span class="dv">5</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave   <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3674</span>     <span class="ot">NA</span>        Forest Park Ave         </a>
<a class="sourceLine" id="cb34-12" data-line-number="12"> <span class="dv">6</span>     <span class="dv">6</span>      <span class="dv">6</span> Mizu Sushi Bar                  <span class="dv">1013</span> Washington Avenue <span class="dv">9</span><span class="op">/</span><span class="dv">12</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1013</span>     <span class="ot">NA</span>        Washington  Ave         </a>
<a class="sourceLine" id="cb34-13" data-line-number="13"> <span class="dv">7</span>     <span class="dv">7</span>      <span class="dv">7</span> Sapporo <span class="dv">2</span>                       <span class="dv">3043</span> Olive St          <span class="dv">3</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3043</span>     <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-14" data-line-number="14"> <span class="dv">8</span>     <span class="dv">8</span>      <span class="dv">7</span> Sapporo <span class="dv">2</span>                       <span class="dv">3043</span> Olive St          <span class="dv">7</span><span class="op">/</span><span class="dv">3</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3043</span>     <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-15" data-line-number="15"> <span class="dv">9</span>     <span class="dv">9</span>      <span class="dv">8</span> Sub Zero Vodka Bar              <span class="dv">308</span> N Euclid Ave       <span class="dv">12</span><span class="op">/</span><span class="dv">7</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">308</span>      N         Euclid      Ave         </a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="dv">10</span>    <span class="dv">10</span>      <span class="dv">9</span> Sushi Ai                        <span class="dv">910</span> Olive St           <span class="dv">3</span><span class="op">/</span><span class="dv">29</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="dv">11</span>    <span class="dv">11</span>      <span class="dv">9</span> Sushi Ai                        <span class="dv">910</span> Olive St           <span class="dv">5</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-18" data-line-number="18"><span class="dv">12</span>    <span class="dv">12</span>     <span class="dv">10</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">6</span><span class="op">/</span><span class="dv">17</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-19" data-line-number="19"><span class="dv">13</span>    <span class="dv">13</span>     <span class="dv">10</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">8</span><span class="op">/</span><span class="dv">25</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-20" data-line-number="20"><span class="dv">14</span>    <span class="dv">14</span>     <span class="dv">10</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">10</span><span class="op">/</span><span class="dv">30</span><span class="op">/</span><span class="dv">18</span> <span class="dv">910</span>      <span class="ot">NA</span>        Olive       St          </a>
<a class="sourceLine" id="cb34-21" data-line-number="21"><span class="dv">15</span>    <span class="dv">15</span>     <span class="dv">11</span> SUSHI KOI                       <span class="dv">4</span> N EUCLID AVE         <span class="dv">1</span><span class="op">/</span><span class="dv">17</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4</span>        N         Euclid      Ave   </a></code></pre></div>
<p>The replacement process includes an <code>unnest</code> argument, which will convert the house range list-columns into individual observations.</p>
<p>With our addresses replaced, we can then rebuild address strings them with <code>pm.rebuild()</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>sushi2_parsed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pm_rebuild.html">pm_rebuild</a></span>(sushi2_parsed, <span class="dt">start =</span> pm.house, <span class="dt">end =</span> pm.streetSuf, <span class="dt">keep_parsed =</span> <span class="st">"no"</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="er">&gt;</span><span class="st"> </span>sushi2_parsed</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co"># A tibble: 15 x 4</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">   name                            address                visit    pm.address          </a>
<a class="sourceLine" id="cb35-6" data-line-number="6">   <span class="op">&lt;</span>chr<span class="op">&gt;</span><span class="st">                           </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">                  </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>chr<span class="op">&gt;</span><span class="st">               </span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="st"> </span><span class="dv">1</span> BaiKu Sushi Lounge              <span class="dv">3407</span> Olive St          <span class="dv">3</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">3407</span> Olive St       </a>
<a class="sourceLine" id="cb35-8" data-line-number="8"> <span class="dv">2</span> Cafe Mochi                      <span class="dv">3221</span> S Grand Boulevard <span class="dv">10</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">18</span> <span class="dv">3221</span> S Grand Blvd   </a>
<a class="sourceLine" id="cb35-9" data-line-number="9"> <span class="dv">3</span> Drunken Fish <span class="op">-</span><span class="st"> </span>Central West End <span class="dv">1</span> Maryland Plaza       <span class="dv">12</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1</span> Maryland Plz      </a>
<a class="sourceLine" id="cb35-10" data-line-number="10"> <span class="dv">4</span> Kampai Sushi Bar                <span class="dv">4949</span> W Pine Blvd       <span class="dv">2</span><span class="op">/</span><span class="dv">13</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4949</span> W Pine Blvd    </a>
<a class="sourceLine" id="cb35-11" data-line-number="11"> <span class="dv">5</span> Midtown Sushi <span class="op">&amp;</span><span class="st"> </span>Ramen           <span class="dv">3674</span> Forest Park Ave   <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3674</span> Forest Park Ave</a>
<a class="sourceLine" id="cb35-12" data-line-number="12"> <span class="dv">6</span> Mizu Sushi Bar                  <span class="dv">1013</span> Washington Avenue <span class="dv">9</span><span class="op">/</span><span class="dv">12</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">1013</span> Washington Ave </a>
<a class="sourceLine" id="cb35-13" data-line-number="13"> <span class="dv">7</span> Sapporo <span class="dv">2</span>                       <span class="dv">3043</span> Olive St          <span class="dv">3</span><span class="op">/</span><span class="dv">1</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3043</span> Olive St       </a>
<a class="sourceLine" id="cb35-14" data-line-number="14"> <span class="dv">8</span> Sapporo <span class="dv">2</span>                       <span class="dv">3043</span> Olive St          <span class="dv">7</span><span class="op">/</span><span class="dv">3</span><span class="op">/</span><span class="dv">18</span>   <span class="dv">3043</span> Olive St       </a>
<a class="sourceLine" id="cb35-15" data-line-number="15"> <span class="dv">9</span> Sub Zero Vodka Bar              <span class="dv">308</span> N Euclid Ave       <span class="dv">12</span><span class="op">/</span><span class="dv">7</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">308</span> N Euclid Ave    </a>
<a class="sourceLine" id="cb35-16" data-line-number="16"><span class="dv">10</span> Sushi Ai                        <span class="dv">910</span> Olive St           <span class="dv">3</span><span class="op">/</span><span class="dv">29</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span> Olive St        </a>
<a class="sourceLine" id="cb35-17" data-line-number="17"><span class="dv">11</span> Sushi Ai                        <span class="dv">910</span> Olive St           <span class="dv">5</span><span class="op">/</span><span class="dv">20</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span> Olive St        </a>
<a class="sourceLine" id="cb35-18" data-line-number="18"><span class="dv">12</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">6</span><span class="op">/</span><span class="dv">17</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span> Olive St        </a>
<a class="sourceLine" id="cb35-19" data-line-number="19"><span class="dv">13</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">8</span><span class="op">/</span><span class="dv">25</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">910</span> Olive St        </a>
<a class="sourceLine" id="cb35-20" data-line-number="20"><span class="dv">14</span> Sushi Ai                        <span class="dv">910</span> Olive Street       <span class="dv">10</span><span class="op">/</span><span class="dv">30</span><span class="op">/</span><span class="dv">18</span> <span class="dv">910</span> Olive St        </a>
<a class="sourceLine" id="cb35-21" data-line-number="21"><span class="dv">15</span> SUSHI KOI                       <span class="dv">4</span> N EUCLID AVE         <span class="dv">1</span><span class="op">/</span><span class="dv">17</span><span class="op">/</span><span class="dv">18</span>  <span class="dv">4</span> N Euclid Ave </a></code></pre></div>
<p>The <code>keep_parsed</code> argument has options to retain some data, including city, state, and postal code, when a full address was present in the source data (use <code>keep_parsed = "limited"</code>) or to keep all parsed data (with <code>keep_parsed = "yes"</code>). The <code>keep_ids</code> argument will retain the <code>pm.id</code> and <code>pm.uid</code> variables. Finally, there is a <code>new_address</code> argument to specify the name of the new variable with the rebuild address. If not specified, <code>pm.address</code> is used as the default variable name.</p>
</div>
</div>
<div id="getting-help" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-help" class="anchor"></a>Getting Help</h2>
<ul>
<li>If you are new to <code>R</code> itself, welcome! Hadley Wickham’s <a href="http://r4ds.had.co.nz"><em>R for Data Science</em></a> is an excellent way to get started with data manipulation in the tidyverse, which <code>stlcsb</code> is designed to integrate seamlessly with.</li>
<li>If you have questions about using <code>postmastr</code>, you are encouraged to use the <a href="https://community.rstudio.com">RStudio Community forums</a>. Please create a <a href="http://reprex.tidyverse.org/"><code>reprex</code></a> before posting. Feel free to tag Chris (<code>@chris.prener</code>) in any posts about <code>postmastr</code>.</li>
<li>If you think you’ve found a bug, please create a <a href="http://reprex.tidyverse.org/"><code>reprex</code></a> and then open an issue on <a href="https://github.com/slu-openGIS/stlcsb/issues/new/choose">GitHub</a>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#a-grammar-of-street-addresses">A Grammar of Street Addresses</a></li>
      <li><a href="#creating-dictionaries">Creating Dictionaries</a></li>
      <li><a href="#sample-data">Sample Data</a></li>
      <li><a href="#omnibus-parsing-functionality">Omnibus Parsing Functionality</a></li>
      <li><a href="#the-postmastr-workflow">The <code>postmastr</code> Workflow</a></li>
      <li><a href="#getting-help">Getting Help</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://chris-prener.github.io">Christopher Prener</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
